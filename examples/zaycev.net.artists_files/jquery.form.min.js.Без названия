(function(b){function r(a){var c=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(this).ajaxSubmit(c))}function v(a){var c=a.target,h=b(c);if(!h.is(":submit,input:image")){c=h.closest(":submit");if(0==c.length)return;c=c[0]}var f=this;f.clk=c;"image"==c.type&&(void 0!=a.offsetX?(f.clk_x=a.offsetX,f.clk_y=a.offsetY):"function"==typeof b.fn.offset?(h=h.offset(),f.clk_x=a.pageX-h.left,f.clk_y=a.pageY-h.top):(f.clk_x=a.pageX-c.offsetLeft,f.clk_y=a.pageY-c.offsetTop));setTimeout(function(){f.clk=f.clk_x=
f.clk_y=null},100)}function s(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var w,x;w=void 0!==b("<input type='file'/>").get(0).files;x=void 0!==window.FormData;b.fn.ajaxSubmit=function(a){function c(c){for(var f=new FormData,e=0;e<c.length;e++)f.append(c[e].name,c[e].value);if(a.extraData)for(var h in a.extraData)f.append(h,a.extraData[h]);
a.data=null;c=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:"POST"});c.data=null;var m=c.beforeSend;c.beforeSend=function(b,d){d.data=f;b.upload&&(b.upload.onprogress=function(a){d.progress(a.position,a.total)});m&&m.call(d,b,a)};b.ajax(c)}function h(c){function e(){function a(){try{var b=(p.contentWindow?p.contentWindow.document:p.contentDocument?p.contentDocument:p.document).readyState;s("state = "+b);"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){s("Server abort: ",
c," (",c.name,")"),h(A),y&&clearTimeout(y),y=void 0}}var c=m.attr("target"),k=m.attr("action");l.setAttribute("target",r);f||l.setAttribute("method","POST");k!=d.url&&l.setAttribute("action",d.url);d.skipEncodingOverride||f&&!/post/i.test(f)||m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});d.timeout&&(y=setTimeout(function(){v=!0;h(w)},d.timeout));var g=[];try{if(d.extraData)for(var n in d.extraData)g.push(b('<input type="hidden" name="'+n+'">').attr("value",d.extraData[n]).appendTo(l)[0]);
d.iframeTarget||(u.appendTo("body"),p.attachEvent?p.attachEvent("onload",h):p.addEventListener("load",h,!1));setTimeout(a,15);l.submit()}finally{l.setAttribute("action",k),c?l.setAttribute("target",c):m.removeAttr("target"),b(g).remove()}}function h(a){if(!k.aborted&&!C){try{t=p.contentWindow?p.contentWindow.document:p.contentDocument?p.contentDocument:p.document}catch(c){s("cannot access response document: ",c),a=A}if(a===w&&k)k.abort("timeout");else if(a==A&&k)k.abort("server abort");else if(t&&
t.location.href!=d.iframeSrc||v){p.detachEvent?p.detachEvent("onload",h):p.removeEventListener("load",h,!1);a="success";var e;try{if(v)throw"timeout";var f="xml"==d.dataType||t.XMLDocument||b.isXMLDoc(t);s("isXml="+f);if(!f&&window.opera&&(null==t.body||""==t.body.innerHTML)&&--E){s("requeing onLoad callback, DOM not available");setTimeout(h,250);return}var g=t.body?t.body:t.documentElement;k.responseText=g?g.innerHTML:null;k.responseXML=t.XMLDocument?t.XMLDocument:t;f&&(d.dataType="xml");k.getResponseHeader=
function(a){return{"content-type":d.dataType}[a]};g&&(k.status=Number(g.getAttribute("status"))||k.status,k.statusText=g.getAttribute("statusText")||k.statusText);var l=(d.dataType||"").toLowerCase(),n=/(json|script|text)/.test(l);if(n||d.textarea){var m=t.getElementsByTagName("textarea")[0];if(m)k.responseText=m.value,k.status=Number(m.getAttribute("status"))||k.status,k.statusText=m.getAttribute("statusText")||k.statusText;else if(n){var r=t.getElementsByTagName("pre")[0],z=t.getElementsByTagName("body")[0];
r?k.responseText=r.textContent?r.textContent:r.innerText:z&&(k.responseText=z.textContent?z.textContent:z.innerText)}}else"xml"!=l||k.responseXML||null==k.responseText||(k.responseXML=F(k.responseText));try{x=G(k,l,d)}catch(D){a="parsererror",k.error=e=D||a}}catch(B){s("error caught: ",B),a="error",k.error=e=B||a}k.aborted&&(s("upload aborted"),a=null);k.status&&(a=200<=k.status&&300>k.status||304===k.status?"success":"error");"success"===a?(d.success&&d.success.call(d.context,x,"success",k),q&&b.event.trigger("ajaxSuccess",
[k,d])):a&&(void 0==e&&(e=k.statusText),d.error&&d.error.call(d.context,k,a,e),q&&b.event.trigger("ajaxError",[k,d,e]));q&&b.event.trigger("ajaxComplete",[k,d]);q&&!--b.active&&b.event.trigger("ajaxStop");d.complete&&d.complete.call(d.context,k,a);C=!0;d.timeout&&clearTimeout(y);setTimeout(function(){d.iframeTarget||u.remove();k.responseXML=null},100)}}}var l=m[0],g,n,d,q,r,u,p,k,v,y;g=!!b.fn.prop;if(c)if(g)for(n=0;n<c.length;n++)g=b(l[c[n].name]),g.prop("disabled",!1);else for(n=0;n<c.length;n++)g=
b(l[c[n].name]),g.removeAttr("disabled");if(b(":input[name=submit],:input[id=submit]",l).length)alert('Error: Form elements must not have name or id of "submit".');else if(d=b.extend(!0,{},b.ajaxSettings,a),d.context=d.context||d,r="jqFormIO"+(new Date).getTime(),d.iframeTarget?(u=b(d.iframeTarget),g=u.attr("name"),null==g?u.attr("name",r):r=g):(u=b('<iframe name="'+r+'" src="'+d.iframeSrc+'" />'),u.css({position:"absolute",top:"-1000px",left:"-1000px"})),p=u[0],k={aborted:0,responseText:null,responseXML:null,
status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var c="timeout"===a?"timeout":"aborted";s("aborting upload... "+c);this.aborted=1;u.attr("src",d.iframeSrc);k.error=c;d.error&&d.error.call(d.context,k,c,a);q&&b.event.trigger("ajaxError",[k,d,c]);d.complete&&d.complete.call(d.context,k,c)}},(q=d.global)&&!b.active++&&b.event.trigger("ajaxStart"),q&&b.event.trigger("ajaxSend",[k,d]),d.beforeSend&&!1===d.beforeSend.call(d.context,
k,d))d.global&&b.active--;else if(!k.aborted){(c=l.clk)&&(g=c.name)&&!c.disabled&&(d.extraData=d.extraData||{},d.extraData[g]=c.value,"image"==c.type&&(d.extraData[g+".x"]=l.clk_x,d.extraData[g+".y"]=l.clk_y));var w=1,A=2;c=b("meta[name=csrf-token]").attr("content");(g=b("meta[name=csrf-param]").attr("content"))&&c&&(d.extraData=d.extraData||{},d.extraData[g]=c);d.forceSync?e():setTimeout(e,10);var x,t,E=50,C,F=b.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),
b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},H=b.parseJSON||function(a){return window.eval("("+a+")")},G=function(a,c,d){var e=a.getResponseHeader("content-type")||"",f="xml"===c||!c&&0<=e.indexOf("xml");a=f?a.responseXML:a.responseText;f&&"parsererror"===a.documentElement.nodeName&&b.error&&b.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,c));"string"===typeof a&&("json"===c||
!c&&0<=e.indexOf("json")?a=H(a):("script"===c||!c&&0<=e.indexOf("javascript"))&&b.globalEval(a));return a}}}if(!this.length)return s("ajaxSubmit: skipping submit process - no element selected"),this;var f,e,m=this;"function"==typeof a&&(a={success:a});f=this.attr("method");e=this.attr("action");(e=(e="string"===typeof e?b.trim(e):"")||window.location.href||"")&&(e=(e.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:e,success:b.ajaxSettings.success,type:f||"GET",iframeSrc:/^https/i.test(window.location.href||
"")?"javascript:false":"about:blank"},a);e={};this.trigger("form-pre-serialize",[this,a,e]);if(e.veto)return s("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return s("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var n=a.traditional;void 0===n&&(n=b.ajaxSettings.traditional);var g,l=this.formToArray(a.semantic);a.data&&(a.extraData=a.data,g=b.param(a.data,n));if(a.beforeSubmit&&!1===a.beforeSubmit(l,this,a))return s("ajaxSubmit: submit aborted via beforeSubmit callback"),
this;this.trigger("form-submit-validate",[l,this,a,e]);if(e.veto)return s("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;e=b.param(l,n);g&&(e=e?e+"&"+g:g);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+e,a.data=null):a.data=e;var q=[];a.resetForm&&q.push(function(){m.resetForm()});a.clearForm&&q.push(function(){m.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var r=a.success||function(){};q.push(function(c){var e=a.replaceTarget?"replaceWith":"html";
b(a.target)[e](c).each(r,arguments)})}else a.success&&q.push(a.success);a.success=function(b,c,e){for(var f=a.context||a,g=0,h=q.length;g<h;g++)q[g].apply(f,[b,c,e||m,m])};g=0<b("input:file:enabled[value]",this).length;e="multipart/form-data"==m.attr("enctype")||"multipart/form-data"==m.attr("encoding");n=w&&x;s("fileAPI :"+n);!1!==a.iframe&&(a.iframe||(g||e)&&!n)?a.closeKeepAlive?b.get(a.closeKeepAlive,function(){h(l)}):h(l):(g||e)&&n?(a.progress=a.progress||b.noop,c(l)):b.ajax(a);this.trigger("form-submit-notify",
[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&0===this.length){var c=this.selector,h=this.context;if(!b.isReady&&c)return s("DOM not ready, queuing ajaxForm"),b(function(){b(c,h).ajaxForm(a)}),this;s("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return a.delegation?(b(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,v).on("submit.form-plugin",
this.selector,a,r).on("click.form-plugin",this.selector,a,v),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,r).bind("click.form-plugin",a,v)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a){var c=[];if(0===this.length)return c;var h=this[0],f=a?h.getElementsByTagName("*"):h.elements;if(!f)return c;var e,m,n,g,l,q;e=0;for(q=f.length;e<q;e++)if(l=f[e],n=l.name)if(a&&h.clk&&"image"==l.type)l.disabled||h.clk!=l||(c.push({name:n,
value:b(l).val(),type:l.type}),c.push({name:n+".x",value:h.clk_x},{name:n+".y",value:h.clk_y}));else if((g=b.fieldValue(l,!0))&&g.constructor==Array)for(m=0,l=g.length;m<l;m++)c.push({name:n,value:g[m]});else if(w&&"file"==l.type&&!l.disabled)for(g=l.files,m=0;m<g.length;m++)c.push({name:n,value:g[m],type:l.type});else null!==g&&"undefined"!=typeof g&&c.push({name:n,value:g,type:l.type});!a&&h.clk&&(a=b(h.clk),f=a[0],(n=f.name)&&!f.disabled&&"image"==f.type&&(c.push({name:n,value:a.val()}),c.push({name:n+
".x",value:h.clk_x},{name:n+".y",value:h.clk_y})));return c};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];this.each(function(){var h=this.name;if(h){var f=b.fieldValue(this,a);if(f&&f.constructor==Array)for(var e=0,m=f.length;e<m;e++)c.push({name:h,value:f[e]});else null!==f&&"undefined"!=typeof f&&c.push({name:this.name,value:f})}});return b.param(c)};b.fn.fieldValue=function(a){for(var c=[],h=0,f=this.length;h<f;h++){var e=b.fieldValue(this[h],
a);null===e||"undefined"==typeof e||e.constructor==Array&&!e.length||(e.constructor==Array?b.merge(c,e):c.push(e))}return c};b.fieldValue=function(a,c){var h=a.name,f=a.type,e=a.tagName.toLowerCase();void 0===c&&(c=!0);if(c&&(!h||a.disabled||"reset"==f||"button"==f||("checkbox"==f||"radio"==f)&&!a.checked||("submit"==f||"image"==f)&&a.form&&a.form.clk!=a||"select"==e&&-1==a.selectedIndex))return null;if("select"==e){var m=a.selectedIndex;if(0>m)return null;for(var h=[],e=a.options,n=(f="select-one"==
f)?m+1:e.length,m=f?m:0;m<n;m++){var g=e[m];if(g.selected){var l=g.value;l||(l=g.attributes&&g.attributes.value&&!g.attributes.value.specified?g.text:g.value);if(f)return l;h.push(l)}}return h}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var b=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var h=this.type,
f=this.tagName.toLowerCase();b.test(h)||"textarea"==f||a&&/hidden/.test(h)?this.value="":"checkbox"==h||"radio"==h?this.checked=!1:"select"==f&&(this.selectedIndex=-1)})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var c=this.type;
"checkbox"==c||"radio"==c?this.checked=a:"option"==this.tagName.toLowerCase()&&(c=b(this).parent("select"),a&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1})(jQuery);